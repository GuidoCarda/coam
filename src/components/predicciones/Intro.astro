---
import Action from "../Action.astro";
---

<h1>Intro</h1>
<Action theme="white" as="button" id="login">Login</Action>

<script>
  document.addEventListener("astro:page-load", () => {
    const $loginBtn = document.querySelector("#login");

    $loginBtn?.addEventListener("click", () => {
      const width = 600;
      const height = 700;
      const left = window.innerWidth / 2 - width / 2;
      const top = window.innerHeight / 2 - height / 2;

      window.open(
        "/auth/google",
        "Google login",
        `toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=${width}, height=${height}, top=${top}, left=${left}`
      );

      $loginBtn.setAttribute("aria-disabled", "true");
      $loginBtn.textContent = "Iniciando sesión...";

      setTimeout(() => {
        $loginBtn.removeAttribute("aria-disabled");
        $loginBtn.textContent = "¡Inicia sesión para participar!";
      }, 3000);
    });
  });
</script>
